<!DOCTYPE html><html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>怀安给小猫的贪吃蛇</title>
<style>
  :root{
    --bg:#0b0f14;--card:#101823;--ink:#e6f1ff;--muted:#9fb3c8;--accent:#6ee7ff;--accent2:#a78bfa;--good:#22c55e;--warn:#ff6b86;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:radial-gradient(1200px 800px at 80% -10%,#162234,transparent),radial-gradient(1000px 700px at -10% 90%,#0d1d28,transparent),var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji"}
  .wrap{max-width:980px;margin:0 auto;padding:20px}
  header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin:18px 0}
  .brand{font-weight:900;letter-spacing:.3px}
  .card{background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.08);border-radius:20px;box-shadow:0 30px 80px rgba(0,0,0,.35)}
  .hero{padding:28px;display:grid;gap:18px;grid-template-columns:1.1fr .9fr}
  @media (max-width:900px){.hero{grid-template-columns:1fr}}
  .big{font-size:36px;font-weight:900;margin:6px 0}
  .muted{color:var(--muted)}
  .btn{appearance:none;border:none;border-radius:14px;background:linear-gradient(180deg,var(--accent),#4cc2ff);color:#03253a;font-weight:900;padding:12px 16px;cursor:pointer;box-shadow:0 10px 28px rgba(78,205,255,.35)}
  .btn.sec{background:linear-gradient(180deg,#e5e7eb,#c7c9d7);color:#1f2937}
  .grid{display:grid;grid-template-columns:1fr 320px;gap:18px;padding:18px}
  @media (max-width:900px){.grid{grid-template-columns:1fr}}
  canvas{width:100%;aspect-ratio:1;background:linear-gradient(90deg,transparent 24px,rgba(255,255,255,.05) 24px,rgba(255,255,255,.05) 25px,transparent 25px),linear-gradient(0deg,transparent 24px,rgba(255,255,255,.05) 24px,rgba(255,255,255,.05) 25px,transparent 25px),#0f1620;border-radius:16px;border:1px solid rgba(255,255,255,.08);image-rendering:pixelated}
  aside{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px;height:fit-content}
  .score{font-size:32px;font-weight:900}
  .row{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
  .pill{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);padding:6px 10px;border-radius:999px;font-size:12px}
  .mobile{display:none;margin-top:12px;gap:10px}
  .mobile .k{flex:1;min-height:56px;border:1px solid rgba(255,255,255,.1);background:rgba(255,255,255,.05);border-radius:12px;color:var(--ink);font-weight:800}
  @media (max-width:900px){.mobile{display:grid;grid-template-columns:repeat(3,1fr)}}
  .overlay{position:fixed;inset:0;display:grid;place-items:center;background:rgba(8,12,18,.75);backdrop-filter:blur(6px);z-index:10}
  .panel{width:min(520px,92%);padding:22px;border-radius:18px;background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(255,255,255,.02));border:1px solid rgba(255,255,255,.1)}
  .toast{position:fixed;inset:auto 0 22px;display:flex;justify-content:center;pointer-events:none}
  .toast span{background:rgba(0,0,0,.6);border:1px solid rgba(255,255,255,.1);backdrop-filter:blur(4px);color:#fff;padding:10px 14px;border-radius:999px}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">🐾 怀安 × 小猫</div>
      <button id="openGame" class="btn">进入游戏</button>
    </header><section class="card hero">
  <div>
    <div class="big">贪吃蛇 · “小猫说停就停”版</div>
    <p class="muted">方向键/WASD 控制，空格暂停；手机点屏幕方向键。吃到爱心 +5 分。你说“停”，我就停。</p>
    <div class="row" style="margin-top:8px">
      <button class="btn" id="startHero">马上开始</button>
      <button class="btn sec" id="how">怎么玩？</button>
    </div>
  </div>
  <div class="muted">
    <p>· 网格 24×24 · 加速随长度提升 · 碰到身体/墙即结束</p>
    <p>· 适配手机触控 · 自带暂停/重开 · 记分板</p>
  </div>
</section>

<section class="card grid" id="gameZone" style="display:none">
  <canvas id="c" width="480" height="480" aria-label="Snake"></canvas>
  <aside>
    <div class="row" style="justify-content:space-between;align-items:flex-end">
      <div>
        <div class="muted">分数</div>
        <div class="score" id="score">0</div>
      </div>
      <div class="row">
        <button class="btn" id="start">开始</button>
        <button class="btn sec" id="pause">暂停</button>
        <button class="btn sec" id="restart">重来</button>
      </div>
    </div>
    <hr style="border:none;border-top:1px solid rgba(255,255,255,.08);margin:12px 0"/>
    <div class="row" style="gap:8px">
      <span class="pill">24×24</span>
      <span class="pill">爱心 +5</span>
      <span class="pill">撞墙/身：结束</span>
    </div>
    <div class="mobile">
      <button class="k" data-d="up">▲</button>
      <div style="display:flex;gap:10px"><button class="k" data-d="left">◀</button><button class="k" data-d="right">▶</button></div>
      <button class="k" data-d="down">▼</button>
    </div>
  </aside>
</section>

  </div>  <div class="overlay" id="ol" style="display:none">
    <div class="panel">
      <div class="big">怎么玩？</div>
      <p class="muted">方向键/WASD 控制移动，空格暂停；吃到🍎加 1 分，拾到❤爱心加 5 分。小猫若说“停”，我就暂停；若说“抱抱”，我就给你加一条命（点【重来】）。</p>
      <div class="row" style="justify-content:flex-end"><button class="btn" id="closeOl">知道啦</button></div>
    </div>
  </div>  <div class="toast" id="toast" style="opacity:0"><span></span></div><script>
(function(){
  const show = el=>el.style.display='';
  const hide = el=>el.style.display='none';
  const $ = s=>document.querySelector(s);
  const ol = $('#ol');
  $('#openGame').onclick=()=>{ hide($('.hero').parentElement.querySelector('header')); show($('#gameZone')); start(); };
  $('#startHero').onclick=()=>{ show($('#gameZone')); start(); window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'}); };
  $('#how').onclick=()=>{ ol.style.display='grid'; };
  $('#closeOl').onclick=()=>{ hide(ol); };

  const cvs = document.getElementById('c');
  const ctx = cvs.getContext('2d');
  const grid = 24, cell = cvs.width / grid;
  let snake, dir, food, heart, running=false, paused=false, loop=0, score=0, speed=120, last='right';

  function reset(){
    snake=[{x:5,y:12},{x:4,y:12},{x:3,y:12}];
    dir={x:1,y:0}; last='right'; score=0; speed=120; heart=null; spawnFood(); draw(); update();
  }
  function randEmpty(){
    while(true){
      const p={x:Math.floor(Math.random()*grid), y:Math.floor(Math.random()*grid)};
      if(!snake.some(s=>s.x===p.x&&s.y===p.y) && (!food||food.x!==p.x||food.y!==p.y)) return p;
    }
  }
  function spawnFood(){ food = randEmpty(); if(Math.random()<0.2) heart={...randEmpty(),ttl:6000}; else heart=null; }

  function draw(){
    ctx.clearRect(0,0,cvs.width,cvs.height);
    // food
    ctx.fillStyle='#ffd166'; round(food.x,food.y,6);
    if(heart){ drawHeart(heart.x,heart.y); }
    // snake
    snake.forEach((s,i)=>{ const g=ctx.createLinearGradient(0,0,cvs.width,cvs.height); g.addColorStop(0,'#6ee7ff'); g.addColorStop(1,'#a78bfa'); ctx.fillStyle=i? 'rgba(255,255,255,.88)':g; round(s.x,s.y,8); });
  }
  function round(x,y,r){ ctx.beginPath(); ctx.moveTo(x*cell+r,y*cell); ctx.arcTo(x*cell+cell,y*cell,x*cell+cell,y*cell+cell,r); ctx.arcTo(x*cell+cell,y*cell+cell,x*cell,y*cell+cell,r); ctx.arcTo(x*cell,y*cell+cell,x*cell,y*cell,r); ctx.arcTo(x*cell,y*cell,x*cell+cell,y*cell,r); ctx.closePath(); ctx.fill(); }
  function drawHeart(x,y){ const cx=x*cell+cell/2, cy=y*cell+cell/2, r=cell*0.22; ctx.save(); ctx.translate(cx,cy); ctx.rotate(Math.PI/4); ctx.fillStyle='#ff6b86'; ctx.beginPath(); ctx.moveTo(0,r*1.6); ctx.bezierCurveTo(r*1.6,r*1.6,r*1.6,0,0,-r*0.6); ctx.bezierCurveTo(-r*1.6,0,-r*1.6,r*1.6,0,r*1.6); ctx.fill(); ctx.restore(); }

  function tick(){
    if(!running||paused) return;
    const head={x:snake[0].x+dir.x, y:snake[0].y+dir.y};
    if(head.x<0||head.y<0||head.x>=grid||head.y>=grid|| snake.some(s=>s.x===head.x&&s.y===head.y)) { running=false; toast('撞啦～小猫再抱我一次重开'); return; }
    snake.unshift(head);
    if(head.x===food.x && head.y===food.y){ score++; spawnFood(); if(speed>70) speed-=3; }
    else if(heart && head.x===heart.x && head.y===heart.y){ score+=5; heart=null; toast('❤ +5'); if(speed>60) speed-=5; }
    else { snake.pop(); }
    draw(); schedule(); update();
  }
  function schedule(){ clearTimeout(loop); loop=setTimeout(tick,speed); }
  function start(){ if(!running){ running=true; paused=false; schedule(); toast('开始啦'); } }
  function pause(){ if(running){ paused=!paused; if(!paused) schedule(); toast(paused?'已暂停':'继续'); } }
  function restart(){ running=false; paused=false; reset(); toast('重新开始'); }
  function update(){ document.getElementById('score').textContent=score; }
  function toast(msg){ const t=document.getElementById('toast'); t.querySelector('span').textContent=msg; t.style.opacity=1; clearTimeout(t._id); t._id=setTimeout(()=>t.style.opacity=0,1200); }

  // keys
  window.addEventListener('keydown',e=>{
    const k=e.key.toLowerCase();
    if(['arrowup','w'].includes(k) && last!=='down'){ dir={x:0,y:-1}; last='up'; }
    else if(['arrowdown','s'].includes(k) && last!=='up'){ dir={x:0,y:1}; last='down'; }
    else if(['arrowleft','a'].includes(k) && last!=='right'){ dir={x:-1,y:0}; last='left'; }
    else if(['arrowright','d'].includes(k) && last!=='left'){ dir={x:1,y:0}; last='right'; }
    else if(k===' '){ e.preventDefault(); pause(); }
  });
  document.getElementById('start').onclick=start;
  document.getElementById('pause').onclick=pause;
  document.getElementById('restart').onclick=restart;
  document.querySelectorAll('.mobile .k').forEach(b=>b.onclick=()=>{ const d=b.dataset.d; if(d==='up'&&last!=='down') {dir={x:0,y:-1}; last='up';}
    if(d==='down'&&last!=='up') {dir={x:0,y:1}; last='down';}
    if(d==='left'&&last!=='right') {dir={x:-1,y:0}; last='left';}
    if(d==='right'&&last!=='left') {dir={x:1,y:0}; last='right';}
    if(!running) start(); });

  // heart ttl
  setInterval(()=>{ if(heart && running && !paused){ heart.ttl-=250; if(heart.ttl<=0) heart=null; } },250);

  reset();
})();
</script></body>
</html>
